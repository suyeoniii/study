## Transaction

### 트랜잭션이란?

데이터베이스 상태를 변경시키기 위해 수행되는 작업의 단위
수행되는 여러 질의어를 하나의 작업단위로 묶을 수 있음

### 트랜잭션 특징 - ACID

1. 원자성(Atomicity) 작업이 모두 반영되던지 아니면 전혀 반영되지 않아야 한다.
2. 일관성(Consistency) 실행이 완료되면 언제나 일관성 있는 상태를 유지해야 한다.
3. 독립성(Isolation) 둘 이상 트랜잭션이 동시에 실행될 경우 서로의 연산에 끼어들 수 없다.
4. 영속성(Durability) 완료된 결과는 영구적으로 반영되어야 한다.

### 트랜잭션 레벨 (격리수준)

- READ UNCOMMITTED
- READ COMMITTED
- REPEATABLE READ
  자신의 트랜잭션 번호보다 낮은 트랜잭션 번호에서 변경된(+커밋된) 것만 보게 되는 것
- SERIALIZABLE

아래로 내려갈 수록 고립정도는 높아지고, 성능은 떨어진다
(oracle = READ COMMITTED, mysql = REPEATABLE READ)

#### Dirty READ

A 트랜잭션에서 10번 사원의 나이를 27살에서 28살로 바꿈
아직 커밋하지 않음
B 트랜잭션에서 10번 사원의 나이를 조회함
28살이 조회됨
이를 더티 리드(Dirty Read)라고 한다

A 트랜잭션에서 문제가 발생해 ROLLBACK함
B 트랜잭션은 10번 사원이 여전히 28살이라고 생각하고 로직을 수행함

#### Phantom READ

한 트랜잭션 내에서 같은 쿼리를 두번 실행했는데 첫번째 쿼리에서 없던 레코드가 두번째 쿼리에서 나타나는 것

### Commit

트랜잭션이 성공적으로 끝나서 데이터베이스가 일관성있는 상태가 되었을 때 완료되었음을 알려주는 연산

### Rollback

하나의 트랜잭션 처리가 비정상적으로 종료되어 변경된 결과를 취소하는 연산

### 더 찾아볼것

- commit 과정
- rollback 과정
- 스프링의 @Transactional 작동 원리
- 하나의 DB가 아닌 여러 DB에 대해 어떻게 Transaction을 적용할 수 있을까?
