## Process & Thread

### 프로세스란?

- 저장장치로부터 메모리에 적재되어 실행중인 프로그램
- 메모리 영역
  - Code - 실행할 코드, 명령어들이 기계어로 저장된 형태
  - Data - 전역 변수, 정적 변수가 저장되는 영역
  - Stack - 함수 안에서 선언된 지역변수, 매개변수, 리턴값 등이 저장됨
  - Heap - 관리 가능한 데이터 외의 다른 형태의 데이터를 관리하기 위한 공간

#### 프로세스 상태

- new, ready, waiting, running, terminated

### 스레드란?

- 프로세스 내에서 실행되는 흐름의 단위
- 하나의 프로세스는 기본적으로 하나의 스레드를 가지고 있으며, 여러 스레드를 동시에 가질 수도 있다. (멀티스레드)
- 별도의 register, stack을 가지며, 나머지(code, heap)는 프로세스내 다른 스레드와 공유한다.

### 프로세스와 스레드의 차이

<img src='../../image/process&thread.png'>

- 프로세스는 메모리 상에서 실행중인 프로그램, 스레드는 프로세스 내에서 실행되는 흐름의 단위
- 프로세스는 최소 하나의 스레드를 가지고 있음
- 프로세스는 각 주소공간(code, data, heap, stack)을 독립적으로 할당받고 스레드는 stack, register만 따로 할당받고 나머지는 스레드끼리 공유

### 멀티프로세스

- 다수의 프로세서가 협력적으로 하나 이상의 작업을 동시에 처리하는 것
- 프로세스 중 하나에 문제가 생겨도 다른 프로세스에 영향을 주지 않음
- 독립된 메모리 영역이기 때문에 작업량이 많을수록 Context Switching이 자주 일어나 오버헤드가 발생할 가능성있음

### 멀티스레드

- 하나의 프로세스에 여러 스레드로 지원을 공유하며 작업를 나누어 수행하는 것
- 멀티 프로세스보다 적은 메모리 공간을 차지하고 Context Switching이 빠른 장점이 있음
- 동기화 문제로 한 스레드의 장애로 전체 스레드에 영향을 끼칠 수 있음

### 병렬 프로그래밍

- 동시적으로 실행되는 코드와 로직의 흐름을 만들어내는 것 (= 여러 스레드를 만들어 동작시키는 것)
- 동기화가 중요
- 데드락, 라이브락, 기아 상태, 성능 저하가 발생할 수 있음

### Context Switching

실행중인 프로세스를 전환하는 작업

- Context Switching을 위해 현재 실행중인 프로세스의 정보를 저장해야함 -> PCB (프로세스 제어블럭)에 저장
- 프로세스1을 다시 실행하게 되는 경우, 프로세스1의 PCB를 로드하여 사용함

### IPC

- 프로세스간 통신
- 프로세스간 공유해야하는 정보가 있는 경우 필요함

#### Message Passing

- 프로세스 A, B가 있을 때 프로세스A가 메세지를 발신하면 프로세스 B 실행 가
- 동기화 과정을 커널에 위임하여 자동으로 처리하게함 (=커널을 거쳐서 다른 프로세스의 메모리로 전달되는 것)
- OS의 오버헤드가 커짐

#### Shared Memory

- 프로세스간 공유할 수 있는 메모리 영역 지정
- producer 프로세스가 생산한 정보를 shared memory에 입력
- 그 후 consumer 프로세스가 정보를 읽음
- consumer는 데이터가 writing 되었는지 알 수 없어서 직접 정의해주어야함
- OS 오버헤드는 적지만 운용 난이도는 올라감

#### 참고자료

https://cocoon1787.tistory.com/849
https://preamtree.tistory.com/10
https://hbase.tistory.com/308
https://velog.io/@kbpark9898/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%8A%A4%EC%9C%84%EC%B9%AD
